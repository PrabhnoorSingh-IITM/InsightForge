<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>InsightForge - E-Commerce Intelligence Research Agent</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:wght@600;700&family=Sora:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  </head>
  <body>
    <div class="page">
      <header class="header">
        <div class="hero">
          <p class="eyebrow">ðŸš€ Research Made Simple</p>
          <h1>E-Commerce Intelligence Agent</h1>
          <p class="subtitle">Analyze your products in minutes. Get actionable insights backed by data.</p>
          <p class="description">Upload your datasets or use our samples. Our agent finds gaps, flags risks, and gives you strategies.</p>
        </div>
      </header>

      <!-- Onboarding Tour Section -->
      <section class="onboarding">
        <div class="tour-card">
          <div class="tour-step">
            <div class="tour-number">1</div>
            <h3>Tell Us Your Goal</h3>
            <p>Pick "Quick" for fast answers or "Deep" for comprehensive strategy. Choose what matters to you: growth, retention, profitability, or market expansion.</p>
          </div>
          <div class="tour-step">
            <div class="tour-number">2</div>
            <h3>Choose Your Data</h3>
            <p>Use our built-in sample datasets for instant results, or upload your own CSVs. Our system auto-detects and maps your data.</p>
          </div>
          <div class="tour-step">
            <div class="tour-number">3</div>
            <h3>Get Smart Insights</h3>
            <p>Receive a structured report with confidence scores, risk flags, and actionable recommendations. All in plain language.</p>
          </div>
        </div>
        <button id="startTourBtn" class="cta-button">Start Your Analysis</button>
      </section>

      <main class="grid">
        <!-- LEFT PANEL: Analysis Configuration -->
        <section class="panel panel-l">
          <div class="panel-header">
            <h2>Analysis Setup</h2>
            <p>Tell us what you want to analyze and how.</p>
          </div>

          <div class="field">
            <label>Mode</label>
            <select id="mode">
              <option value="quick">Quick</option>
              <option value="deep" selected>Deep</option>
            </select>
            <span id="modeError" class="field-error"></span>
          </div>

          <div class="field">
            <label>Business Goal</label>
            <select id="goal">
              <option value="growth">Growth</option>
              <option value="retention">Retention</option>
              <option value="profitability">Profitability</option>
              <option value="market expansion">Market Expansion</option>
            </select>
            <span id="goalError" class="field-error"></span>
          </div>

          <div class="field split">
            <div>
              <label>Scope Type</label>
              <select id="scopeType">
                <option value="SKU">SKU</option>
                <option value="Category">Category</option>
              </select>
            </div>
            <div>
              <label>Scope Value</label>
              <input id="scopeValue" placeholder="e.g., SKU-472 or Bluetooth Earbuds" />
              <span id="scopeValueError" class="field-error"></span>
            </div>
          </div>

          <div class="field split">
            <div>
              <label>Marketplace</label>
              <input id="marketplace" placeholder="e.g., Amazon" />
            </div>
            <div>
              <label>Region</label>
              <input id="region" placeholder="e.g., India" />
            </div>
          </div>

          <div class="field">
            <label>Timeframe</label>
            <input id="timeframe" placeholder="e.g., Last 30 days" />
          </div>

          <div class="run-row">
            <button id="runBtn" class="primary">
              <span class="btn-text">Run Analysis</span>
              <span class="spinner" aria-hidden="true"></span>
            </button>
            <button id="demoBtn" class="secondary">Load demo values</button>
            <small style="text-align: center; color: var(--muted); margin-top: 4px;">ðŸ‘‡ New? Try "Load demo values" first!</small>
            <p id="runStatus" class="status-text"></p>
          </div>
          <div id="alert" class="alert hidden"></div>
        </section>

        <!-- CENTER PANEL: Dataset Management -->
        <section class="panel panel-c">
          <div class="panel-header">
            <h2>Data Sources</h2>
            <p>Use sample or upload your CSVs.</p>
          </div>

          <div class="field">
            <label>Data Mode</label>
            <div class="segmented">
              <label>
                <input type="radio" name="dataMode" value="sample" checked />
                Sample datasets
              </label>
              <label>
                <input type="radio" name="dataMode" value="upload" />
                Upload CSVs
              </label>
            </div>
          </div>

          <div class="field" id="uploadField">
            <label>Upload CSV files</label>
            <input id="fileInput" type="file" accept=".csv" multiple />
            <small>Files are parsed in-browser and sent inline to the API.</small>
          </div>

          <div id="fileList" class="file-list"></div>

          <div class="mapping" id="mappingPanel">
            <h3>Dataset Mapping</h3>
            <div class="mapping-grid">
              <div class="mapping-item">
                <span>Catalog</span>
                <span id="mapCatalog" class="map-status">Not mapped</span>
              </div>
              <div class="mapping-item">
                <span>Reviews</span>
                <span id="mapReviews" class="map-status">Not mapped</span>
              </div>
              <div class="mapping-item">
                <span>Pricing</span>
                <span id="mapPricing" class="map-status">Not mapped</span>
              </div>
              <div class="mapping-item">
                <span>Competitors</span>
                <span id="mapCompetitors" class="map-status">Not mapped</span>
              </div>
              <div class="mapping-item">
                <span>Performance</span>
                <span id="mapPerformance" class="map-status">Not mapped</span>
              </div>
            </div>
          </div>
        </section>

        <!-- RIGHT PANEL: Research Output -->
        <section class="panel panel-r">
          <div class="panel-header">
            <h2>Research Output</h2>
            <p>Insights, metrics, and recommendations.</p>
          </div>

          <div class="metrics-row">
            <div class="metric-card">
              <div class="metric-label">Confidence</div>
              <div id="confidenceScore" class="metric-value">--</div>
              <span id="confidenceBadge" class="badge badge-muted">--</span>
            </div>
            <div class="metric-card">
              <div class="metric-label">Completeness</div>
              <div id="completenessScore" class="metric-value">--</div>
              <div id="completenessMeter" class="completeness-meter">
                <div class="meter-progress"></div>
              </div>
            </div>
          </div>

          <div class="section">
            <h3>Risk Flags</h3>
            <ul id="riskList" class="list muted">
              <li>No report yet.</li>
            </ul>
          </div>

          <div class="section">
            <h3>Strategic Recommendations</h3>
            <ul id="recommendations" class="list highlight">
              <li>Run analysis to generate recommendations.</li>
            </ul>
          </div>

          <div class="section">
            <h3>Full Report (Markdown)</h3>
            <div id="report" class="report">Waiting for analysis...</div>
          </div>
        </section>
      </main>
    </div>

    <div id="toast" class="toast hidden">Report loaded successfully.</div>

    <script type="module" src="config.js"></script>
    <script type="module" src="api.js"></script>
    <script type="module" src="ui.js"></script>
    <script type="module" src="app.js"></script>
  </body>
</html>
